<!DOCTYPE html>
<html lang="en"><!-- Basic -->
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">   
   
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
 
     <!-- Site Metas -->
    <title>Transctions</title>  
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">    
	<!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">    
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">
		<style>
		  .custom-container {
		    background-color: #f8f9fa; /* Adjust the shade of gray as needed */
		    color: #333; /* Set the text color */
		  }
		</style>
</head>

<body>



	<!-- Start header -->
	<header class="top-navbar">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<div class="container">
				<a class="navbar-brand" href="admin.html">
					<img src="images/logo.png" height="80" alt="" />
				</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbars-rs-food" aria-controls="navbars-rs-food" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbars-rs-food">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item"><a class="nav-link" href="admin.html">Home</a></li>
						<li class="nav-item"><a class="nav-link" href="menulist.html">Menu</a></li>
						<li class="nav-item active"><a class="nav-link" href="transactions.html">Transactions</a></li>
						<li class="nav-item"><a class="nav-link" data-toggle="modal" data-target="#logoutModal">Logout</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<!-- End header -->


	<div class="about-sections-box" >
		<div class="custom-container container" style="padding-top: 200px;">
		  <div class="row">
		    <div class="col-md-12">
		      <h1 class="text-center">Transactions Table</h1>
		      <table class="table table-bordered table-responsive-sm table-striped">
		        <thead class="thead-dark">
		          <tr>
		            <th scope="col">ID</th>
		            <th scope="col">Date</th>
		            <th scope="col">Time</th>
		            <th scope="col">Customer Email</th>
		            <th scope="col">Delivery Address</th>
		            <th scope="col">Payment Mode</th>
		            <th scope="col">Order Details</th>
		            <th scope="col">Total</th>
		          </tr>
		        </thead>
		        <tbody id="transactions-table"></tbody>
		      </table>
		    </div>
		  </div>
		</div>
  </div>


		<!-- Logout Modal -->
		<div class="modal" id="logoutModal" tabindex="-1" role="dialog">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title">Confirm Logout</h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      <div class="modal-body">
		        <p>Are you sure you want to log out?</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
		        <button type="button" class="btn btn-danger" id="logout-btn">Logout</button>
		      </div>
		    </div>
		  </div>
		</div>
	
	<!-- Start Contact info -->
	<div class="contact-imfo-box">
		<div class="container">
			<div class="row">
				<div class="col-md-4 arrow-right">
					<i class="fa fa-volume-control-phone"></i>
					<div class="overflow-hidden">
						<h4>Phone</h4>
						<p class="lead">
							+63 997 163 4841
						</p>
					</div>
				</div>
				<div class="col-md-4 arrow-right">
					<i class="fa fa-envelope"></i>
					<div class="overflow-hidden">
						<h4>Email</h4>
						<p class="lead">
							genobebe10@gmail.com
						</p>
					</div>
				</div>
				<div class="col-md-4">
					<i class="fa fa-map-marker"></i>
					<div class="overflow-hidden">
						<h4>Location</h4>
						<p class="lead">
							105, Samson Road St, Caloocan
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Contact info -->
	
	<!-- Start Footer -->
	<footer class="footer-area bg-f">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<h3>About Us</h3>
					<p>KS Cuisine is a food business that started by selling baked beef lasagna. The owner, a passionate cook, started the business with the goal of sharing her love of food with others. As the business began to grow, the owner saw an opportunity to expand the menu by adding more dishes that she personally enjoyed and believed would be popular among her customers.</p>
				</div>
				<div class="col-lg-3 col-md-6">
					<h3>Subscribe</h3>
					<div class="subscribe_form">
						<form class="subscribe_form">
							<input name="EMAIL" id="subs-email" class="form_input" placeholder="Email Address..." type="email">
							<button type="submit" class="submit">SUBSCRIBE</button>
							<div class="clearfix"></div>
						</form>
					</div>
					<ul class="list-inline f-social">
						<li class="list-inline-item"><a href="https://www.facebook.com/profile.php?id=100068002704860"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
					</ul>
				</div>
				<div class="col-lg-3 col-md-6">
					<h3>Contact information</h3>
					<p class="lead">UE-Caloocan, Samson Road, Caloocan, Philippines</p>
					<p class="lead"><a href="#">+63 997 163 4841</a></p>
					<p><a href="#"> genobebe10@gmail.com</a></p>
				</div>
				<div class="col-lg-3 col-md-6">
					<h3>Opening hours</h3>
					<p><span class="text-color">Monday: </span>Closed</p>
					<p><span class="text-color">Tue-Wed :</span> 9:Am - 10PM</p>
					<p><span class="text-color">Thu-Fri :</span> 9:Am - 10PM</p>
					<p><span class="text-color">Sat-Sun :</span> 5:PM - 10PM</p>
				</div>
			</div>
		</div>
		
		<div class="copyright">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<p class="company-name">All Rights Reserved. &copy; 2020 <a href="#">KS Cuisine</a> Design By : 
					<a href="https://html.design/">JC's group</a></p>
					</div>
				</div>
			</div>
		</div>
		
	</footer>
	<!-- End Footer -->
	
	<a href="#" id="back-to-top" title="Back to top" style="display: none;"><i class="fa fa-paper-plane-o" aria-hidden="true"></i></a>

	<!-- ALL JS FILES -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
	<script src="js/jquery.superslides.min.js"></script>
	<script src="js/images-loded.min.js"></script>
	<script src="js/isotope.min.js"></script>
	<script src="js/baguetteBox.min.js"></script>
	<script src="js/form-validator.min.js"></script>
  <script src="js/contact-form-script.js"></script>
  <script src="js/custom.js"></script>

  <script type="module">
	 // Import the functions you need from the SDKs you need
		import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js';
		import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-analytics.js";
		
		// TODO: Add SDKs for Firebase products that you want to use
		// https://firebase.google.com/docs/web/setup#available-libraries

		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
		  apiKey: "AIzaSyB4mZ38aXTLeiQdnlr6qfweQioYKG0j1yU",
		  authDomain: "ks-cuisine.firebaseapp.com",
		  databaseURL: "https://ks-cuisine-default-rtdb.firebaseio.com",
		  projectId: "ks-cuisine",
		  storageBucket: "ks-cuisine.appspot.com",
		  messagingSenderId: "446458909737",
		  appId: "1:446458909737:web:8976d968b60ae0b3f0f838",
		  measurementId: "G-4DW5VGPK6B"
		};

		import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut, sendPasswordResetEmail, updateEmail, deleteUser } from 'https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js'
		import { getDatabase, ref, set, limitToLast, get, orderByKey, query, equalTo, onValue, orderByChild, remove, update, child } from 'https://www.gstatic.com/firebasejs/9.21.0/firebase-database.js';

		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);
		const auth = getAuth();
		const database = getDatabase();
		const logoutBtn = document.getElementById('logout-btn');

		// Logout any authenticated user from admin
		logoutBtn.addEventListener('click', async () => {
		  await signOut(auth);
			window.location.href = 'index.html';
			alert("Admin has been logout.");

		});

		document.addEventListener("DOMContentLoaded", function() {
		  const transactionsTable = document.getElementById("transactions-table");

		  // Retrieve the transactions from the Realtime Database
		  get(ref(database, 'Transactions')).then(snapshot => {
		    const transactions = snapshot.val();

		    if (transactions && Array.isArray(transactions)) {
		      transactions.forEach(transaction => {
		      	const address = `${transaction.deliveryAddress.houseNumber}, ${transaction.deliveryAddress.street}, ${transaction.deliveryAddress.district}, ${transaction.deliveryAddress.city}`;
		        // Create a new table row
		        const row = document.createElement("tr");

		        // Add transaction data to the table row
		        row.innerHTML = `
		          <td>${transaction.transactionID}</td>
		          <td>${transaction.date}</td>
		          <td>${transaction.time}</td>
		          <td>${transaction.customerEmail}</td>
		          <td>${address}</td>
		          <td>${transaction.paymentMode}</td>
		          <td>
		            <ul>
		              ${transaction.orderDetails.map(order => `<li>${order.menuName}: ${order.quantity} x ₱${order.price} - Total: ₱${order.total}</li>`).join('')}
		            </ul><br>
		          </td>
		          <td>${transaction.total}</td>
		        `;

		        // Append the table row to the transactions table
		        transactionsTable.appendChild(row);
		      });
		    } else {
		      // No transactions found
		      const noTransactionsMessage = "<tr><td colspan='9'>No transactions found.</td></tr>";
		      transactionsTable.innerHTML = noTransactionsMessage;
		    }
		  }).catch(error => {
		    console.log('Error retrieving transactions:', error);
		  });
		});


</script>
  
</body>
</html>