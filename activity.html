<!DOCTYPE html>
<html lang="en"><!-- Basic -->
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">   
   
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
 
     <!-- Site Metas -->
    <title>Staff</title>  
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">    
	<!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">    
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">
      <style>
    .order-box {
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
      margin-bottom: 10px;
      text-align: center;
    }
  	</style>	

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>
	<!-- Start header -->
	<header class="top-navbar">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<div class="container">
				<a class="navbar-brand" href="index.html">
					<img src="images/logo.png" height="80" alt="" />
				</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbars-rs-food" aria-controls="navbars-rs-food" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbars-rs-food">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
						<li class="nav-item"><a class="nav-link" href="menu.html">Menu</a></li>
						<li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Pages</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="reservation.html">Reservation</a>
								<a class="dropdown-item" href="stuff.html">Staff</a>
								<a class="dropdown-item" href="gallery.html">Gallery</a>
							</div>
						</li>
						<li class="nav-item active"><a class="nav-link" href="activity.html">Activity</a></li>
						<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<!-- End header -->
	
	<!-- Start All Pages -->
	<div class="all-page-title page-breadcrumb">
		<div class="container text-center">
			<div class="row">
				<div class="col-lg-12">
					<h1>Recent Orders</h1>
				</div>
			</div>
		</div>
	</div>
	<!-- End All Pages -->
	
	<!-- Start Stuff -->
	<div class="container">
	  <div class="card">
	    <div class="card-body">
	      <h1 class="mt-4">Activity</h1>
	      <div id="ordersContainer"></div>
	    </div>
	  </div>
	</div>
	<!-- End Stuff -->
	
	
	<!-- Start Contact info -->
	<div class="contact-imfo-box">
		<div class="container">
			<div class="row">
				<div class="col-md-4 arrow-right">
					<i class="fa fa-volume-control-phone"></i>
					<div class="overflow-hidden">
						<h4>Phone</h4>
						<p class="lead">
							+63 997 163 4841
						</p>
					</div>
				</div>
				<div class="col-md-4 arrow-right">
					<i class="fa fa-envelope"></i>
					<div class="overflow-hidden">
						<h4>Email</h4>
						<p class="lead">
							genobebe10@gmail.com
						</p>
					</div>
				</div>
				<div class="col-md-4">
					<i class="fa fa-map-marker"></i>
					<div class="overflow-hidden">
						<h4>Location</h4>
						<p class="lead">
							105, Samson Road St, Caloocan
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Contact info -->
	
	<!-- Start Footer -->
	<footer class="footer-area bg-f">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<h3>About Us</h3>
					<p>KS Cuisine is a food business that started by selling baked beef lasagna. The owner, a passionate cook, started the business with the goal of sharing her love of food with others. As the business began to grow, the owner saw an opportunity to expand the menu by adding more dishes that she personally enjoyed and believed would be popular among her customers.</p>
				</div>
				<div class="col-lg-3 col-md-6">
					<h3>Subscribe</h3>
					<div class="subscribe_form">
						<form class="subscribe_form">
							<input name="EMAIL" id="subs-email" class="form_input" placeholder="Email Address..." type="email">
							<button type="submit" class="submit">SUBSCRIBE</button>
							<div class="clearfix"></div>
						</form>
					</div>
					<ul class="list-inline f-social">
						<li class="list-inline-item"><a href="https://www.facebook.com/profile.php?id=100068002704860"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
					</ul>
				</div>
				<div class="col-lg-3 col-md-6">
					<h3>Contact information</h3>
					<p class="lead">UE-Caloocan, Samson Road, Caloocan, Philippines</p>
					<p class="lead"><a href="#">+63 997 163 4841</a></p>
					<p><a href="#"> genobebe10@gmail.com</a></p>
				</div>
				<div class="col-lg-3 col-md-6">
					<h3>Opening hours</h3>
					<p><span class="text-color">Monday: </span>Closed</p>
					<p><span class="text-color">Tue-Wed :</span> 9:Am - 10PM</p>
					<p><span class="text-color">Thu-Fri :</span> 9:Am - 10PM</p>
					<p><span class="text-color">Sat-Sun :</span> 5:PM - 10PM</p>
				</div>
			</div>
		</div>
		
		<div class="copyright">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<p class="company-name">All Rights Reserved. &copy; 2020 <a href="#">KS Cuisine</a> Design By : 
					<a href="https://html.design/">JC's group</a></p>
					</div>
				</div>
			</div>
		</div>
		
	</footer>
	<!-- End Footer -->
	
	<a href="#" id="back-to-top" title="Back to top" style="display: none;"><i class="fa fa-paper-plane-o" aria-hidden="true"></i></a>

	<!-- ALL JS FILES -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
	<script src="js/jquery.superslides.min.js"></script>
	<script src="js/images-loded.min.js"></script>
	<script src="js/isotope.min.js"></script>
	<script src="js/baguetteBox.min.js"></script>
	<script src="js/form-validator.min.js"></script>
    <script src="js/contact-form-script.js"></script>
    <script src="js/custom.js"></script>
		<script type="module">
		  // Import the functions you need from the SDKs you need
		  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js';
		  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-analytics.js";
		  import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js';
		  import { getDatabase, ref, onValue, get} from 'https://www.gstatic.com/firebasejs/9.21.0/firebase-database.js';

		  // Your web app's Firebase configuration
		  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
		  apiKey: "AIzaSyB4mZ38aXTLeiQdnlr6qfweQioYKG0j1yU",
		  authDomain: "ks-cuisine.firebaseapp.com",
		  databaseURL: "https://ks-cuisine-default-rtdb.firebaseio.com",
		  projectId: "ks-cuisine",
		  storageBucket: "ks-cuisine.appspot.com",
		  messagingSenderId: "446458909737",
		  appId: "1:446458909737:web:8976d968b60ae0b3f0f838",
		  measurementId: "G-4DW5VGPK6B"
		};

		  // Initialize Firebase
		  const app = initializeApp(firebaseConfig);
		  const analytics = getAnalytics(app);
		  const auth = getAuth();
		  const database = getDatabase();
		  const transactionsRef = ref(database, "Transactions");

			document.addEventListener("DOMContentLoaded", function() {
			  // Listen for changes in the user's authentication state
			  onAuthStateChanged(auth, async function(user) {
			    if (user) {
			      // Retrieve the user's email
			      const userEmail = user.email;

			      // Retrieve the transactions from the Realtime Database
			      const snapshot = await get(ref(database, 'Transactions'));
			      const transactions = snapshot.val();

			      // Check if there are any transactions
			      if (transactions && Array.isArray(transactions)) {
			        // Filter transactions based on the user's email
			        const userTransactions = transactions.filter(transaction => transaction.customerEmail === userEmail);

			        if (userTransactions.length > 0) {
			          // Build the HTML for displaying transactions
			          let transactionsHTML = '';

			          userTransactions.forEach(transaction => {

			          	const address = `${transaction.deliveryAddress.houseNumber}, ${transaction.deliveryAddress.street}, ${transaction.deliveryAddress.district}, ${transaction.deliveryAddress.city}`;

			          	console.log(address);
			            // Build the HTML for each transaction
			            transactionsHTML += `
			              <div class="card mt-4">
			                <div class="card-body">
			                  <h2 class="card-title">Transaction ID: ${transaction.transactionID}</h2>
			                  <hr>
			                  <h3>Order Details:</h3>
			                  <ul class="list-unstyled">
			              `;

			            transaction.orderDetails.forEach(order => {
			              transactionsHTML += `
			                <li>${order.menuName}: ${order.quantity} x ₱${order.price} - Total: ₱${order.total}</li>
			              `;
			            });

			            transactionsHTML += `
			                  </ul>
			                  <br>
			                  Delivery Address: ${address} <br>
			                  Payment Mode: ${transaction.paymentMode}<br>
			                  Date: ${transaction.date}
			                  <hr>
			                  <h3>Total: ₱${transaction.total}</h3>
			                </div>
			              </div>
			            `;
			          });

			          // Set the transactions HTML to the container element
			          const ordersContainer = document.getElementById("ordersContainer");
			          ordersContainer.innerHTML = transactionsHTML;
			        } else {
			          // No transactions found for the user
			          const noTransactionsMessage = "<p>No transactions found.</p>";
			          const ordersContainer = document.getElementById("ordersContainer");
			          ordersContainer.innerHTML = noTransactionsMessage;
			        }
			      } else {
			        // No transactions found
			        const noTransactionsMessage = "<p>No transactions found.</p>";
			        const ordersContainer = document.getElementById("ordersContainer");
			        ordersContainer.innerHTML = noTransactionsMessage;
			      }
			    } else {
			      // No logged-in user
			      const noUserMessage = "<p>No user is currently logged in.</p>";
			      const ordersContainer = document.getElementById("ordersContainer");
			      ordersContainer.innerHTML = noUserMessage;
			    }
			  });
			});


		</script>

</body>
</html>